{% extends 'base.html' %}

{% block body %}

<div class="container">
  <h1>Add Employee Data</h1>
  <form action="/" method="post">
    <div class="mb-3">
      <label for="" class="form-label">Full Name</label>
      <input type="text" class="form-control" name="name" id="" placeholder="Enter Full Name" required>
    </div>
    <div class="mb-3">
      <label for="" class="form-label">Email</label>
      <input type="email" class="form-control" name="email" id="" placeholder="Enter Email" required>
    </div>
    <div class="mb-3">
      <button type="submit" class="btn btn-primary">Submit</button>
    </div>
  </form>
</div>
<div class="container mt-6">
  <h2 class="text-center"> All Employee Data</h2>
  <form action="/delete_multiple" method="post" id="bulkDeleteForm" onsubmit="return confirmBulkDelete()">
    <div class="mb-3">
      <button type="submit" class="btn btn-danger">Delete Selected</button>
    </div>

    <table class="table">
      <thead>
        <tr>
          <th scope="col"><input type="checkbox" id="selectAll" onclick="toggleSelectAll(this)"></th>
          <th scope="col">SNo.</th>
          <th scope="col">Name</th>
          <th scope="col">Email</th>
          <th scope="col">Action</th>
        </tr>
      </thead>
      <tbody>
        {% for i in allemployee %}
        <tr>
          <td><input type="checkbox" name="employee_ids" value="{{i.sno}}" class="employee-checkbox"></td>
          <th scope="row">{{i.sno}}</th>
          <td>{{i.name}}</td>
          <td>{{i.email}}</td>
          <td>
            <a href="/update/{{i.sno}}" class="btn btn-primary btn-sm">Update</a>
            <a href="/delete/{{i.sno}}" class="btn btn-danger btn-sm"
              onclick="return confirm('Are you sure you want to delete this employee?')">Delete</a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </form>
</div>

<script>
  function toggleSelectAll(source) {
    const checkboxes = document.querySelectorAll('.employee-checkbox');
    checkboxes.forEach(checkbox => checkbox.checked = source.checked);
  }

  function confirmBulkDelete() {
    const checkedBoxes = document.querySelectorAll('.employee-checkbox:checked');
    if (checkedBoxes.length === 0) {
      alert('Please select at least one employee to delete.');
      return false;
    }
    return confirm(`Are you sure you want to delete ${checkedBoxes.length} employee(s)?`);
  }
</script>

{% endblock body %}